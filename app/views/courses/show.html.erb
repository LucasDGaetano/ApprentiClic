<%# SHOW commune pour le cours de la capture d'écran et envoyer un email avec Gmail %>
<%# Section image du cours %>

    <div class="container mt-5">
      <h1 class="title"><strong><%= @course.title %></strong></h1>
      <h2>Pour rappel avant de commencer :</h2>
      <p><%= @course.description %></p>
    </div>

<div class="container">
  <%# Section chapitre du cours %>
  <% @chapters.each do |chapter| %>
    <% users_chapter = current_user.users_chapters.where(chapter_id: chapter).first %>
    <h3 class="title"><%= chapter.title %></h3>
    <p><%= chapter.content.html_safe %></p>
    <div class="text-center">
      <%= cl_image_tag chapter.photo.key, height: 300, width: 800, crop: :fit if chapter.photo.attached?%>
      <%= cl_video_tag chapter.video.key, height: 500, width: 800, crop: :fill, controls: true if chapter.video.attached?%>
    </div>
    <%# Section bouton j'ai compris pour faire évoluer la barre de progression %>
    <%= turbo_frame_tag "done_chapter_#{chapter.id}" do %>
      <%= link_to users_chapter_path(users_chapter), data: { turbo_method: :patch } do %>
          <button class="btn btn-success my-3" <%= 'disabled' if users_chapter.done %>><%= users_chapter.done? %></button>
        <% end %>
      <% end %>
      <hr>
    <% end %>
    <%# Section encart commentaire %>
    <div data-controller="toggle-comments new-comment">
        <button class="btn btn-info" data-action="click->toggle-comments#fire">Voir les commentaires</button>
        <div data-toggle-comments-target="toggable" class="d-none mt-3">
          <div class="my-3">
            <h4 class="title-thin">Commentaires</h4>
            <div data-new-comment-target="commentList">
              <% @course.comments.each do |comment| %>
                <%= render "comments/comment", comment: comment, answer: @answer %>
                <hr>
              <% end %>
            </div>
            <% if @course.comments.none? %>
              <p><em>Ce cours n'a pas encore de commentaires</em> </p>
            <% end %>
          </div>
        </div>
        <%= render "comments/form", course: @course, comment: @comment %>
    </div>
  </div>
